<?xml version="1.0" encoding="utf-8" ?>
<CiTable Src="CurrentTasks.pux">
  <TableName>TasksSearch</TableName>
  <TableCaption>Tasks</TableCaption>
  <RowKey>TaskCode</RowKey>
  <DefaultView>Grid</DefaultView>
  <ColCount>2</ColCount>
  <CiTextField>
    <FieldName>sTaskCode</FieldName>
    <Caption>Task</Caption>
    <Searchable>true</Searchable>
  </CiTextField>
  <CiTextField>
    <FieldName>sTaskDescription</FieldName>
    <Caption>Description</Caption>
    <Searchable>true</Searchable>
  </CiTextField>
  <CiComboField>
    <FieldName>sCustomerCode</FieldName>
    <Caption>Customer</Caption>
    <Code>CustomerCode</Code>
    <Description>Customer</Description>
    <Columns>2</Columns>
    <DropdownSQL>
      select  Customer,
              BillerContact,
              CustomerCode
      from    tblCustomers
      order by CustomerCode
    </DropdownSQL>
    <Searchable>true</Searchable>
  </CiComboField>
  <CiField>
    <FieldName>CompletedGap</FieldName>
    <Computed>true</Computed>
    <Caption>Completed Gap</Caption>
    <ValueSQL>$datediff('d', @CompletedDate, Date())</ValueSQL>
  </CiField>
  <SelectMacro>
    <ActionSQL>
      select  *,
              @CompletedGap as CompletedGap
      from    tblTasks
      where   (TaskCode = @sTaskCode or @sTaskCode is null)
      and     (TaskDescription like '%' + @sTaskDescription + '%' or @sTaskDescription is null)
      and     (CustomerCode = @sCustomerCode or @sCustomerCode is null)
      and     InvoiceNumber is null
      and     (TaskStatus &lt;&gt; "REJECT" or TaskStatus is null)
      and     (PrimaryDeveloper &lt;&gt; "TBA" or PrimaryDeveloper is null)
      order by TaskCode
    </ActionSQL>
  </SelectMacro>
  <CiMacro>
    <MacroName>Task Details</MacroName>
    <MacroType>MENU</MacroType>
    <Caption>*</Caption>
    <ActionSQL>
      select @TaskCode as TaskCode
    </ActionSQL>
    <NavigateUrl>TaskDetails.pux</NavigateUrl>
    <NavigatePos>Popup</NavigatePos>
  </CiMacro>
</CiTable>